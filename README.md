# Django ORM - Домашнее задание

Проект Django для изучения работы с ORM и админкой.

## Структура проекта

- `config/` - настройки Django проекта
- `store/` - приложение магазина
  - `models.py` - модели Category и Product
  - `admin.py` - настройка админки
  - `management/commands/` - кастомные команды

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Выполните миграции:
```bash
python manage.py makemigrations
python manage.py migrate
```

3. Создайте суперпользователя для доступа к админке:
```bash
python manage.py createsuperuser
```

4. Запустите сервер разработки:
```bash
python manage.py runserver
```

## Использование

### Создание данных через кастомную команду

Для создания тестовых данных используйте команду:
```bash
python manage.py create_data
```

Эта команда создаст:
- 3 категории (Электроника, Одежда, Книги)
- 6 товаров в разных категориях

### Доступ к админке

После создания суперпользователя откройте в браузере:
```
http://127.0.0.1:8000/admin/
```

## Модели

### Category
- `name` - название категории
- `description` - описание категории

### Product
- `name` - название товара
- `description` - описание товара
- `price` - цена (DecimalField)
- `created_at` - дата создания
- `category` - связь с Category (ForeignKey)

## Продвинутые функции админки

### Функции для Category

**Список категорий:**
- Отображение количества товаров в категории (цветное отображение)
- Поиск по названию и описанию
- Пагинация (20 элементов на странице)

**Редактирование категории:**
- Инлайн-редактирование товаров прямо в категории
- Возможность добавить новый товар без перехода на другую страницу
- Отображение связанных товаров с их ценами и датами создания

### Функции для Product

**Список товаров:**
- **Форматированная цена** - отображается с символом ₽ и форматированием
- **Статус "Новый"** - автоматическое определение товаров, созданных за последние 7 дней
- **Редактирование в списке** - можно изменять цену и категорию прямо в списке (list_editable)
- Пагинация (25 элементов на страницу)

**Фильтры:**
- По категории
- По дате создания
- По цене
- Date hierarchy - навигация по датам создания вверху списка

**Поиск:**
- По названию товара
- По описанию товара
- По названию категории (через связь ForeignKey)

**Массовые действия:**
- **Увеличить цену на 10%** - массовое изменение цены для выбранных товаров
- **Уменьшить цену на 10%** - массовое изменение цены для выбранных товаров

**Форма редактирования:**
- Поля сгруппированы в fieldsets:
  - "Основная информация" (название, категория)
  - "Описание"
  - "Цена"
  - "Дополнительно" (дата создания - свернуто по умолчанию)
- Поле "Дата создания" только для чтения
- Оптимизация запросов через `list_select_related`

## Проверка работы приложения

### Проверка через админку

1. Запустите сервер:
```bash
python manage.py runserver
```

2. Откройте админку: `http://127.0.0.1:8000/admin/`

3. Проверьте функции:
   - Откройте список категорий - должна быть колонка "Количество товаров"
   - Откройте любую категорию - внизу должны быть инлайн-товары
   - Откройте список товаров - проверьте форматированную цену, статус "Новый"
   - Попробуйте редактировать цену прямо в списке
   - Используйте фильтры и поиск
   - Выберите несколько товаров и примените массовое действие

### Django shell

Для проверки через интерактивную консоль:
```bash
python manage.py shell
```

Примеры команд:
```python
from store.models import Category, Product

# Проверка количества
print(f"Категорий: {Category.objects.count()}")
print(f"Товаров: {Product.objects.count()}")

# Проверка связей
cat = Category.objects.first()
print(f"Товаров в категории '{cat.name}': {cat.products.count()}")

# ORM запросы
products = Product.objects.filter(price__gt=5000)
print(f"Дорогих товаров (>5000): {products.count()}")
```